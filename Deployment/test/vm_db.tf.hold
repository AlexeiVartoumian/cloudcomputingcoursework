# resource "google_compute_instance" "db_instance" {
#     name = "cloud-computing-class-db"
#     machine_type = "e2-micro"

#     boot_disk {
#         initialize_params {
#             image = "ubuntu-os-cloud/ubuntu-2204-lts"
#         }
#     }
#     network_interface {
#         network = "default"
#     access_config {
#     }
#     }
#     # prereq run this ssh-keygen -t rsa -b 4096 -C "your-email@example.com" -f ~/.ssh/gcp-vm-key
#     metadata = {
#         ssh-keys = "ubuntu:${file("~/.ssh/gcp-vm-key.pub")}"
#     }
#     tags = ["db"]
# }



# output "db_public_ip" {
#     description = "Public IP address of the VM instance"
#     value       = local.db_public_ip
# }

# # resource "google_compute_network" "vpc_network" {
# #     name =  "terraform-network"
# #     auto_create_subnetworks = "true"
# # }

# resource "google_compute_firewall" "db_allow" {
#     name    = "db"
#     network = "default"

#     allow {
#         protocol = "icmp"
#     }
#     allow {
#         protocol = "tcp"

#         ports    = ["22", "80", "3001", "27017"]
#     }

#     source_ranges = [var.ansible_ip , local.app_public_ip] 
#     target_tags   = ["db"]
# }

# # resource "local_file" "db_vm" {
# #     filename = "${path.module}/inventory.ini"
# #     content = templatefile("${path.module}/inventory.tpl" , {
# #         vm_ip = "dummy"
# #         db_ip = local.db_public_ip
# #     })   
# # }